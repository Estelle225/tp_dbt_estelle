[0m15:03:57.377932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114131a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114329b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114329700>]}


============================== 15:03:57.387763 | 252df090-e72f-40b6-a870-d6fa6a1a5a48 ==============================
[0m15:03:57.387763 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:03:57.388715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:03:57.389524 [info ] [MainThread]: dbt version: 1.7.10
[0m15:03:57.390068 [info ] [MainThread]: python version: 3.12.2
[0m15:03:57.390572 [info ] [MainThread]: python path: /Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/dbt-env/bin/python3.12
[0m15:03:57.391097 [info ] [MainThread]: os info: macOS-12.7.3-x86_64-i386-64bit
[0m15:03:57.612210 [info ] [MainThread]: Using profiles dir at /Users/estelleclement/.dbt
[0m15:03:57.612995 [info ] [MainThread]: Using profiles.yml file at /Users/estelleclement/.dbt/profiles.yml
[0m15:03:57.613584 [info ] [MainThread]: Using dbt_project.yml file at /Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/dbt_project.yml
[0m15:03:57.615565 [info ] [MainThread]: adapter type: postgres
[0m15:03:57.616168 [info ] [MainThread]: adapter version: 1.7.10
[0m15:03:57.735450 [info ] [MainThread]: Configuration:
[0m15:03:57.736221 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:03:57.736796 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:03:57.737333 [info ] [MainThread]: Required dependencies:
[0m15:03:57.737951 [debug] [MainThread]: Executing "git --help"
[0m15:03:57.786766 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:03:57.788208 [debug] [MainThread]: STDERR: "b''"
[0m15:03:57.789117 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:03:57.789693 [info ] [MainThread]: Connection:
[0m15:03:57.790385 [info ] [MainThread]:   host: 10.4.251.244
[0m15:03:57.790903 [info ] [MainThread]:   port: 5432
[0m15:03:57.791409 [info ] [MainThread]:   user: postgres
[0m15:03:57.791901 [info ] [MainThread]:   database: postgres
[0m15:03:57.792399 [info ] [MainThread]:   schema: public
[0m15:03:57.792894 [info ] [MainThread]:   connect_timeout: 10
[0m15:03:57.793402 [info ] [MainThread]:   role: None
[0m15:03:57.793891 [info ] [MainThread]:   search_path: None
[0m15:03:57.794381 [info ] [MainThread]:   keepalives_idle: 0
[0m15:03:57.795013 [info ] [MainThread]:   sslmode: None
[0m15:03:57.796087 [info ] [MainThread]:   sslcert: None
[0m15:03:57.796931 [info ] [MainThread]:   sslkey: None
[0m15:03:57.797491 [info ] [MainThread]:   sslrootcert: None
[0m15:03:57.798594 [info ] [MainThread]:   application_name: dbt
[0m15:03:57.799800 [info ] [MainThread]:   retries: 1
[0m15:03:57.801062 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:03:57.815658 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:03:57.817666 [debug] [MainThread]: Using postgres connection "debug"
[0m15:03:57.818603 [debug] [MainThread]: On debug: select 1 as id
[0m15:03:57.819394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:57.977809 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:03:57.979787 [debug] [MainThread]: On debug: Close
[0m15:03:57.980615 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:03:57.981395 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:03:57.984915 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.702867, "process_user_time": 3.292216, "process_kernel_time": 0.500042, "process_mem_max_rss": "97873920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:03:57.985979 [debug] [MainThread]: Command `dbt debug` succeeded at 15:03:57.985762 after 0.70 seconds
[0m15:03:57.986608 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:03:57.987339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136315b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114131a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142ca270>]}
[0m15:03:57.988316 [debug] [MainThread]: Flushing usage events
[0m15:06:41.665299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a39cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c5c70>]}


============================== 15:06:41.676199 | 0acdd716-aa0d-4768-be76-fe4bbf657ca9 ==============================
[0m15:06:41.676199 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:06:41.677633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:42.041348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0acdd716-aa0d-4768-be76-fe4bbf657ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95bfe0>]}
[0m15:06:42.175984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0acdd716-aa0d-4768-be76-fe4bbf657ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a39ca40>]}
[0m15:06:42.178025 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:06:42.241893 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:06:42.244478 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:06:42.246103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0acdd716-aa0d-4768-be76-fe4bbf657ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2e8d0>]}
[0m15:06:43.980047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0acdd716-aa0d-4768-be76-fe4bbf657ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c4770>]}
[0m15:06:43.994711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0acdd716-aa0d-4768-be76-fe4bbf657ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1e0290>]}
[0m15:06:43.995536 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:06:43.996090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0acdd716-aa0d-4768-be76-fe4bbf657ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f77d0>]}
[0m15:06:43.998261 [info ] [MainThread]: 
[0m15:06:43.998925 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:06:44.001184 [debug] [MainThread]: Command end result
[0m15:06:44.011144 [info ] [MainThread]: 
[0m15:06:44.012494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:44.013915 [info ] [MainThread]: 
[0m15:06:44.015476 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m15:06:44.021080 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.4449015, "process_user_time": 4.855732, "process_kernel_time": 0.588677, "process_mem_max_rss": "100048896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:44.022720 [debug] [MainThread]: Command `dbt seed` succeeded at 15:06:44.022389 after 2.45 seconds
[0m15:06:44.023898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b103260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af58890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af93c80>]}
[0m15:06:44.024680 [debug] [MainThread]: Flushing usage events
[0m15:18:17.936809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112201e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112201a30>]}


============================== 15:18:17.948232 | 12a511f2-9fb5-4e70-9557-dc2e44a21a4e ==============================
[0m15:18:17.948232 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:18:17.949704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:18.322916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f72180>]}
[0m15:18:18.440009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11260e420>]}
[0m15:18:18.442375 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:18:18.478255 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:18:18.584887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m15:18:18.585619 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/example/stg_sales.sql
[0m15:18:18.586127 [debug] [MainThread]: Partial parsing: added file: tp_dbt://seeds/raw_product_data.csv
[0m15:18:18.586631 [debug] [MainThread]: Partial parsing: added file: tp_dbt://seeds/raw_sales_data.csv
[0m15:18:18.925105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f54890>]}
[0m15:18:18.946271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd36e0>]}
[0m15:18:18.947388 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:18:18.948123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f233b0>]}
[0m15:18:18.950555 [info ] [MainThread]: 
[0m15:18:18.951888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:18.953702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:18:18.974095 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:18:18.974693 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:18:18.975215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:19.131220 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:18:19.133268 [debug] [ThreadPool]: On list_postgres: Close
[0m15:18:19.136898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:18:19.145508 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:18:19.146157 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:18:19.146763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:19.168988 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:19.169602 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:18:19.170096 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:18:19.213411 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:18:19.215378 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:18:19.216807 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:18:19.224048 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:19.224724 [debug] [MainThread]: On master: BEGIN
[0m15:18:19.225260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:19.247939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:19.248715 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:19.249397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:19.273733 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:18:19.275669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e6f7a0>]}
[0m15:18:19.276494 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:19.279169 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:19.279769 [debug] [MainThread]: On master: BEGIN
[0m15:18:19.282122 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:19.282855 [debug] [MainThread]: On master: COMMIT
[0m15:18:19.283931 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:19.284511 [debug] [MainThread]: On master: COMMIT
[0m15:18:19.286102 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:19.286717 [debug] [MainThread]: On master: Close
[0m15:18:19.288114 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:19.289769 [info ] [MainThread]: 
[0m15:18:19.326148 [debug] [Thread-1 (]: Began running node seed.tp_dbt.raw_product_data
[0m15:18:19.326910 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_product_data ................................. [RUN]
[0m15:18:19.328013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now seed.tp_dbt.raw_product_data)
[0m15:18:19.328622 [debug] [Thread-1 (]: Began compiling node seed.tp_dbt.raw_product_data
[0m15:18:19.329344 [debug] [Thread-1 (]: Timing info for seed.tp_dbt.raw_product_data (compile): 15:18:19.329008 => 15:18:19.329017
[0m15:18:19.330026 [debug] [Thread-1 (]: Began executing node seed.tp_dbt.raw_product_data
[0m15:18:19.415554 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_product_data"
[0m15:18:19.416406 [debug] [Thread-1 (]: On seed.tp_dbt.raw_product_data: BEGIN
[0m15:18:19.417992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:19.439431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:19.440134 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_product_data"
[0m15:18:19.440680 [debug] [Thread-1 (]: On seed.tp_dbt.raw_product_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "seed.tp_dbt.raw_product_data"} */

    create table "postgres"."public"."raw_product_data" ("product_id" integer,"product_name" text,"category" text,"price" float8)
  
[0m15:18:19.476208 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m15:18:19.509631 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_product_data"
[0m15:18:19.510265 [debug] [Thread-1 (]: On seed.tp_dbt.raw_product_data: 
          insert into "postgres"."public"."raw_product_data" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m15:18:19.513063 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.0 seconds
[0m15:18:19.520925 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.tp_dbt.raw_product_data"
[0m15:18:19.548293 [debug] [Thread-1 (]: On seed.tp_dbt.raw_product_data: COMMIT
[0m15:18:19.548963 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_product_data"
[0m15:18:19.549571 [debug] [Thread-1 (]: On seed.tp_dbt.raw_product_data: COMMIT
[0m15:18:19.552306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:18:19.553833 [debug] [Thread-1 (]: Timing info for seed.tp_dbt.raw_product_data (execute): 15:18:19.330599 => 15:18:19.553452
[0m15:18:19.554410 [debug] [Thread-1 (]: On seed.tp_dbt.raw_product_data: Close
[0m15:18:19.555723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271cd40>]}
[0m15:18:19.557104 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_product_data ............................. [[32mINSERT 4[0m in 0.23s]
[0m15:18:19.558461 [debug] [Thread-1 (]: Finished running node seed.tp_dbt.raw_product_data
[0m15:18:19.559117 [debug] [Thread-1 (]: Began running node seed.tp_dbt.raw_sales_data
[0m15:18:19.559936 [info ] [Thread-1 (]: 2 of 2 START seed file public.raw_sales_data ................................... [RUN]
[0m15:18:19.560941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.tp_dbt.raw_product_data, now seed.tp_dbt.raw_sales_data)
[0m15:18:19.561527 [debug] [Thread-1 (]: Began compiling node seed.tp_dbt.raw_sales_data
[0m15:18:19.562271 [debug] [Thread-1 (]: Timing info for seed.tp_dbt.raw_sales_data (compile): 15:18:19.561881 => 15:18:19.561888
[0m15:18:19.562793 [debug] [Thread-1 (]: Began executing node seed.tp_dbt.raw_sales_data
[0m15:18:19.620413 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_sales_data"
[0m15:18:19.621014 [debug] [Thread-1 (]: On seed.tp_dbt.raw_sales_data: BEGIN
[0m15:18:19.621575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:19.642734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:19.643493 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_sales_data"
[0m15:18:19.644099 [debug] [Thread-1 (]: On seed.tp_dbt.raw_sales_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "seed.tp_dbt.raw_sales_data"} */

    create table "postgres"."public"."raw_sales_data" ("sale_id" integer,"product_id" integer,"quantity" integer,"sale_date" date,"sale_amount" float8)
  
[0m15:18:19.646945 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m15:18:20.732140 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_sales_data"
[0m15:18:20.732854 [debug] [Thread-1 (]: On seed.tp_dbt.raw_sales_data: 
          insert into "postgres"."public"."raw_sales_data" ("sale_id", "product_id", "quantity", "sale_date", "sale_amount") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s...
[0m15:18:20.744169 [debug] [Thread-1 (]: SQL status: INSERT 0 500 in 0.0 seconds
[0m15:18:20.745475 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.tp_dbt.raw_sales_data"
[0m15:18:20.748675 [debug] [Thread-1 (]: On seed.tp_dbt.raw_sales_data: COMMIT
[0m15:18:20.749282 [debug] [Thread-1 (]: Using postgres connection "seed.tp_dbt.raw_sales_data"
[0m15:18:20.749801 [debug] [Thread-1 (]: On seed.tp_dbt.raw_sales_data: COMMIT
[0m15:18:20.752815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:18:20.754338 [debug] [Thread-1 (]: Timing info for seed.tp_dbt.raw_sales_data (execute): 15:18:19.563132 => 15:18:20.753975
[0m15:18:20.754972 [debug] [Thread-1 (]: On seed.tp_dbt.raw_sales_data: Close
[0m15:18:20.756108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12a511f2-9fb5-4e70-9557-dc2e44a21a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef7260>]}
[0m15:18:20.757208 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file public.raw_sales_data ............................... [[32mINSERT 500[0m in 1.20s]
[0m15:18:20.759269 [debug] [Thread-1 (]: Finished running node seed.tp_dbt.raw_sales_data
[0m15:18:20.763518 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:20.764102 [debug] [MainThread]: On master: BEGIN
[0m15:18:20.764588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:20.834575 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:20.836233 [debug] [MainThread]: On master: COMMIT
[0m15:18:20.837216 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:20.837860 [debug] [MainThread]: On master: COMMIT
[0m15:18:20.839649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:20.840551 [debug] [MainThread]: On master: Close
[0m15:18:20.842196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:20.843101 [debug] [MainThread]: Connection 'seed.tp_dbt.raw_sales_data' was properly closed.
[0m15:18:20.844274 [info ] [MainThread]: 
[0m15:18:20.845077 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m15:18:20.846801 [debug] [MainThread]: Command end result
[0m15:18:20.864197 [info ] [MainThread]: 
[0m15:18:20.865463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:20.866553 [info ] [MainThread]: 
[0m15:18:20.871737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:18:20.877232 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.029909, "process_user_time": 5.159637, "process_kernel_time": 0.674138, "process_mem_max_rss": "111345664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:20.878759 [debug] [MainThread]: Command `dbt seed` succeeded at 15:18:20.878358 after 3.03 seconds
[0m15:18:20.879856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aebb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130817c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264d430>]}
[0m15:18:20.880751 [debug] [MainThread]: Flushing usage events
[0m15:22:32.680798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48dcd0>]}


============================== 15:22:32.691885 | 39af933a-9e3e-442d-a232-1cab3cb73a26 ==============================
[0m15:22:32.691885 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:22:32.692985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:33.074553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39af933a-9e3e-442d-a232-1cab3cb73a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da27380>]}
[0m15:22:33.222582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39af933a-9e3e-442d-a232-1cab3cb73a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c0200>]}
[0m15:22:33.224957 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:22:33.263746 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:22:33.364501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:33.365026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:33.373108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39af933a-9e3e-442d-a232-1cab3cb73a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daf2e10>]}
[0m15:22:33.394626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39af933a-9e3e-442d-a232-1cab3cb73a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e048e90>]}
[0m15:22:33.395670 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:22:33.397711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39af933a-9e3e-442d-a232-1cab3cb73a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dab9760>]}
[0m15:22:33.401182 [info ] [MainThread]: 
[0m15:22:33.402441 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:33.404686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:22:33.425630 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:22:33.426327 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:22:33.426862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:33.543578 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:22:33.545698 [debug] [ThreadPool]: On list_postgres: Close
[0m15:22:33.549624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:22:33.560760 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:22:33.561363 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:22:33.561802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:33.587289 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:33.587886 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:22:33.590478 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:22:33.595379 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:22:33.598993 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:22:33.600502 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:22:33.609086 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:33.609636 [debug] [MainThread]: On master: BEGIN
[0m15:22:33.610054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:33.629453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:33.629995 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:33.630686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:33.641397 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:22:33.643367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39af933a-9e3e-442d-a232-1cab3cb73a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2f3c50>]}
[0m15:22:33.644045 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:33.645572 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:33.646158 [debug] [MainThread]: On master: BEGIN
[0m15:22:33.648063 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:33.648648 [debug] [MainThread]: On master: COMMIT
[0m15:22:33.649118 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:33.649551 [debug] [MainThread]: On master: COMMIT
[0m15:22:33.650645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:22:33.651188 [debug] [MainThread]: On master: Close
[0m15:22:33.652396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:33.653179 [info ] [MainThread]: 
[0m15:22:33.657850 [debug] [Thread-1 (]: Began running node model.tp_dbt.stg_sales
[0m15:22:33.658751 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales ................................... [RUN]
[0m15:22:33.659851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.stg_sales)
[0m15:22:33.660822 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.stg_sales
[0m15:22:33.679305 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.stg_sales"
[0m15:22:33.684206 [debug] [Thread-1 (]: Timing info for model.tp_dbt.stg_sales (compile): 15:22:33.661279 => 15:22:33.683521
[0m15:22:33.685754 [debug] [Thread-1 (]: Began executing node model.tp_dbt.stg_sales
[0m15:22:33.742496 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.stg_sales"
[0m15:22:33.745241 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_sales"
[0m15:22:33.745920 [debug] [Thread-1 (]: On model.tp_dbt.stg_sales: BEGIN
[0m15:22:33.746595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:33.772351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:22:33.773168 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_sales"
[0m15:22:33.773802 [debug] [Thread-1 (]: On model.tp_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.stg_sales"} */

  create view "postgres"."public"."stg_sales__dbt_tmp"
    
    
  as (
    

select
    sale_id,
    product_id,
    quantity::integer as quantity,
    sale_date::date as sale_date
from "postgres"."public"."raw_sales_data"
  );
[0m15:22:33.784601 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:22:33.793298 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_sales"
[0m15:22:33.793936 [debug] [Thread-1 (]: On model.tp_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.stg_sales"} */
alter table "postgres"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m15:22:33.798204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:22:33.849877 [debug] [Thread-1 (]: On model.tp_dbt.stg_sales: COMMIT
[0m15:22:33.850808 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_sales"
[0m15:22:33.851619 [debug] [Thread-1 (]: On model.tp_dbt.stg_sales: COMMIT
[0m15:22:33.879683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:22:33.891932 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_sales__dbt_backup"
[0m15:22:33.905770 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_sales"
[0m15:22:33.906382 [debug] [Thread-1 (]: On model.tp_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.stg_sales"} */
drop view if exists "postgres"."public"."stg_sales__dbt_backup" cascade
[0m15:22:33.908104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:22:33.910975 [debug] [Thread-1 (]: Timing info for model.tp_dbt.stg_sales (execute): 15:22:33.686201 => 15:22:33.910543
[0m15:22:33.911890 [debug] [Thread-1 (]: On model.tp_dbt.stg_sales: Close
[0m15:22:33.919690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39af933a-9e3e-442d-a232-1cab3cb73a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1a2600>]}
[0m15:22:33.921743 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.26s]
[0m15:22:33.923422 [debug] [Thread-1 (]: Finished running node model.tp_dbt.stg_sales
[0m15:22:33.926853 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:33.929054 [debug] [MainThread]: On master: BEGIN
[0m15:22:33.930683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:33.963059 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:33.964612 [debug] [MainThread]: On master: COMMIT
[0m15:22:33.965087 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:33.965692 [debug] [MainThread]: On master: COMMIT
[0m15:22:33.967363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:22:33.967967 [debug] [MainThread]: On master: Close
[0m15:22:33.969421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:33.970027 [debug] [MainThread]: Connection 'model.tp_dbt.stg_sales' was properly closed.
[0m15:22:33.970987 [info ] [MainThread]: 
[0m15:22:33.971680 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m15:22:33.974663 [debug] [MainThread]: Command end result
[0m15:22:34.005532 [info ] [MainThread]: 
[0m15:22:34.006931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:34.008098 [info ] [MainThread]: 
[0m15:22:34.009375 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:34.024152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4348993, "process_user_time": 4.172978, "process_kernel_time": 0.674253, "process_mem_max_rss": "102240256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:34.026796 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:34.026396 after 1.44 seconds
[0m15:22:34.032466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d321ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e193650>]}
[0m15:22:34.033131 [debug] [MainThread]: Flushing usage events
[0m15:59:45.273214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e1c40>]}


============================== 15:59:45.285278 | 8993cf2e-b324-483b-8500-083fd1e157a0 ==============================
[0m15:59:45.285278 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:59:45.286761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_products', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:59:45.677990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8993cf2e-b324-483b-8500-083fd1e157a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114185e50>]}
[0m15:59:45.803378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8993cf2e-b324-483b-8500-083fd1e157a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141148f0>]}
[0m15:59:45.805434 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:59:45.838662 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:59:45.931835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:59:45.932668 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/example/stg_products.sql
[0m15:59:45.933299 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/example/stg_sales.sql
[0m15:59:46.120965 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.tp_dbt.stg_products' (models/example/stg_products.sql) depends on a source named 'raw.raw_product_data' which was not found
[0m15:59:46.127933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9501651, "process_user_time": 3.576514, "process_kernel_time": 0.601418, "process_mem_max_rss": "100818944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:59:46.129131 [debug] [MainThread]: Command `dbt run` failed at 15:59:46.128883 after 0.95 seconds
[0m15:59:46.129850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dc8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114610cb0>]}
[0m15:59:46.130527 [debug] [MainThread]: Flushing usage events
[0m16:00:15.328389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112912c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c09ca0>]}


============================== 16:00:15.340134 | 242c5404-3641-46aa-b743-12cb9eb48d03 ==============================
[0m16:00:15.340134 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:00:15.341483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:00:15.672413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242c5404-3641-46aa-b743-12cb9eb48d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113101880>]}
[0m16:00:15.793342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242c5404-3641-46aa-b743-12cb9eb48d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132772c0>]}
[0m16:00:15.795699 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:00:15.828864 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:00:15.908602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:00:15.909340 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/example/stg_products.sql
[0m16:00:15.909946 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/example/stg_sales.sql
[0m16:00:16.092788 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.tp_dbt.stg_products' (models/example/stg_products.sql) depends on a source named 'raw.raw_product_data' which was not found
[0m16:00:16.098661 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.85883886, "process_user_time": 3.524878, "process_kernel_time": 0.4723, "process_mem_max_rss": "100302848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:00:16.099650 [debug] [MainThread]: Command `dbt seed` failed at 16:00:16.099433 after 0.86 seconds
[0m16:00:16.100259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c09730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138dd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c2bd0>]}
[0m16:00:16.102611 [debug] [MainThread]: Flushing usage events
[0m16:01:45.743016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049060c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104905dc0>]}


============================== 16:01:45.757235 | 217b9daa-101d-477f-97c0-fbf2c8b83dda ==============================
[0m16:01:45.757235 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:01:45.758654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_products', 'send_anonymous_usage_stats': 'True'}
[0m16:01:46.440618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '217b9daa-101d-477f-97c0-fbf2c8b83dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a9d90>]}
[0m16:01:46.636711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '217b9daa-101d-477f-97c0-fbf2c8b83dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3e390>]}
[0m16:01:46.639177 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:01:46.681888 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:01:46.808350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:01:46.809773 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/example/stg_products.sql
[0m16:01:46.811044 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/example/stg_sales.sql
[0m16:01:47.156754 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.tp_dbt.stg_products' (models/example/stg_products.sql) depends on a source named 'raw.raw_product_data' which was not found
[0m16:01:47.166006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5730333, "process_user_time": 5.76293, "process_kernel_time": 0.692876, "process_mem_max_rss": "99700736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:47.167363 [debug] [MainThread]: Command `dbt run` failed at 16:01:47.167082 after 1.58 seconds
[0m16:01:47.169693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048abb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105638200>]}
[0m16:01:47.171468 [debug] [MainThread]: Flushing usage events
[0m16:02:10.785125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c05ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dfdd90>]}


============================== 16:02:10.799419 | ba6a47bc-8d6c-4c91-9796-2a9847e08c6a ==============================
[0m16:02:10.799419 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:02:10.801038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_products', 'send_anonymous_usage_stats': 'True'}
[0m16:02:11.344490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6a47bc-8d6c-4c91-9796-2a9847e08c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b2060>]}
[0m16:02:11.574092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba6a47bc-8d6c-4c91-9796-2a9847e08c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942e930>]}
[0m16:02:11.576799 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:02:11.653156 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:02:11.782700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:02:11.784077 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/example/stg_products.sql
[0m16:02:11.785209 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/example/stg_sales.sql
[0m16:02:12.055737 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_products (models/example/stg_products.sql)
  source() takes exactly two arguments (1 given)
[0m16:02:12.063261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4387559, "process_user_time": 5.366297, "process_kernel_time": 0.691361, "process_mem_max_rss": "99827712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:02:12.064595 [debug] [MainThread]: Command `dbt run` failed at 16:02:12.064336 after 1.44 seconds
[0m16:02:12.065334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c91610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e302f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c1be0>]}
[0m16:02:12.066094 [debug] [MainThread]: Flushing usage events
[0m16:02:48.083038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b921820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94dc10>]}


============================== 16:02:48.102172 | bcfc4954-a265-4a7c-8f98-d0b688cac6ff ==============================
[0m16:02:48.102172 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:02:48.105631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_products', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:48.618235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcfc4954-a265-4a7c-8f98-d0b688cac6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be46330>]}
[0m16:02:48.831494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcfc4954-a265-4a7c-8f98-d0b688cac6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a888f50>]}
[0m16:02:48.834224 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:02:48.897710 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:02:49.007324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:02:49.008581 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/example/stg_products.sql
[0m16:02:49.009589 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/example/stg_sales.sql
[0m16:02:49.254245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcfc4954-a265-4a7c-8f98-d0b688cac6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c58db50>]}
[0m16:02:49.275028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcfc4954-a265-4a7c-8f98-d0b688cac6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f2240>]}
[0m16:02:49.276606 [info ] [MainThread]: Found 4 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:02:49.277941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfc4954-a265-4a7c-8f98-d0b688cac6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba0ffb0>]}
[0m16:02:49.281031 [info ] [MainThread]: 
[0m16:02:49.283336 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:49.288496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:02:49.334830 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:02:49.336702 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:02:49.338547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:49.505857 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:02:49.510871 [debug] [ThreadPool]: On list_postgres: Close
[0m16:02:49.516031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:02:49.531201 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:02:49.532201 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:02:49.533135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:49.564389 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:02:49.565410 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:02:49.566854 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:02:49.578788 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:02:49.581976 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:02:49.584242 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:02:49.599339 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:49.600395 [debug] [MainThread]: On master: BEGIN
[0m16:02:49.601328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:49.636299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:49.637487 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:49.639137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:49.686039 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:02:49.692308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfc4954-a265-4a7c-8f98-d0b688cac6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c664f20>]}
[0m16:02:49.694442 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:49.697063 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:49.698176 [debug] [MainThread]: On master: BEGIN
[0m16:02:49.701667 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:49.703468 [debug] [MainThread]: On master: COMMIT
[0m16:02:49.704697 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:49.705724 [debug] [MainThread]: On master: COMMIT
[0m16:02:49.707906 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:49.708968 [debug] [MainThread]: On master: Close
[0m16:02:49.711996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:49.713926 [info ] [MainThread]: 
[0m16:02:49.721140 [debug] [Thread-1 (]: Began running node model.tp_dbt.stg_products
[0m16:02:49.723320 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m16:02:49.726164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.stg_products)
[0m16:02:49.728064 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.stg_products
[0m16:02:49.764603 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.stg_products"
[0m16:02:49.767950 [debug] [Thread-1 (]: Timing info for model.tp_dbt.stg_products (compile): 16:02:49.729375 => 16:02:49.766966
[0m16:02:49.769356 [debug] [Thread-1 (]: Began executing node model.tp_dbt.stg_products
[0m16:02:49.892394 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.stg_products"
[0m16:02:49.895077 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_products"
[0m16:02:49.896390 [debug] [Thread-1 (]: On model.tp_dbt.stg_products: BEGIN
[0m16:02:49.897497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:49.930871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:49.932361 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_products"
[0m16:02:49.933782 [debug] [Thread-1 (]: On model.tp_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.stg_products"} */

  create view "postgres"."public"."stg_products__dbt_tmp"
    
    
  as (
    

select
    product_id,
    product_name::varchar(255) as product_name,
    category::varchar(50) as category,
    price::numeric(10, 2) as price
from "postgres"."public"."raw_product_data"
  );
[0m16:02:49.979366 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:02:49.995346 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_products"
[0m16:02:49.996567 [debug] [Thread-1 (]: On model.tp_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.stg_products"} */
alter table "postgres"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m16:02:50.000089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:50.061829 [debug] [Thread-1 (]: On model.tp_dbt.stg_products: COMMIT
[0m16:02:50.063216 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_products"
[0m16:02:50.064739 [debug] [Thread-1 (]: On model.tp_dbt.stg_products: COMMIT
[0m16:02:50.090004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:02:50.112570 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_products__dbt_backup"
[0m16:02:50.133366 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.stg_products"
[0m16:02:50.134806 [debug] [Thread-1 (]: On model.tp_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.stg_products"} */
drop view if exists "postgres"."public"."stg_products__dbt_backup" cascade
[0m16:02:50.140479 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:02:50.151288 [debug] [Thread-1 (]: Timing info for model.tp_dbt.stg_products (execute): 16:02:49.769875 => 16:02:50.150377
[0m16:02:50.152893 [debug] [Thread-1 (]: On model.tp_dbt.stg_products: Close
[0m16:02:50.157245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcfc4954-a265-4a7c-8f98-d0b688cac6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c567080>]}
[0m16:02:50.171363 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.43s]
[0m16:02:50.177946 [debug] [Thread-1 (]: Finished running node model.tp_dbt.stg_products
[0m16:02:50.195276 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:50.196365 [debug] [MainThread]: On master: BEGIN
[0m16:02:50.197455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:50.268728 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:50.270181 [debug] [MainThread]: On master: COMMIT
[0m16:02:50.271327 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:50.272514 [debug] [MainThread]: On master: COMMIT
[0m16:02:50.276450 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:50.277830 [debug] [MainThread]: On master: Close
[0m16:02:50.281458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:50.282892 [debug] [MainThread]: Connection 'model.tp_dbt.stg_products' was properly closed.
[0m16:02:50.284250 [info ] [MainThread]: 
[0m16:02:50.285678 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m16:02:50.287996 [debug] [MainThread]: Command end result
[0m16:02:50.338990 [info ] [MainThread]: 
[0m16:02:50.340532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:50.341923 [info ] [MainThread]: 
[0m16:02:50.343651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:02:50.350700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4167738, "process_user_time": 6.080423, "process_kernel_time": 0.751923, "process_mem_max_rss": "106889216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:02:50.353002 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:50.352213 after 2.42 seconds
[0m16:02:50.354954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b353620>]}
[0m16:02:50.356549 [debug] [MainThread]: Flushing usage events
[0m16:06:37.629387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11218d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b5d60>]}


============================== 16:06:37.653927 | dee00871-f2e0-4208-9266-a064ab9b4a3e ==============================
[0m16:06:37.653927 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:06:37.656054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_sales', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:38.195119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dee00871-f2e0-4208-9266-a064ab9b4a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11225e330>]}
[0m16:06:38.416037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dee00871-f2e0-4208-9266-a064ab9b4a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127ebd40>]}
[0m16:06:38.418851 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:06:38.456405 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:06:38.573408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:06:38.574704 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/staging/models.yml
[0m16:06:38.932111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dee00871-f2e0-4208-9266-a064ab9b4a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e59fd0>]}
[0m16:06:38.960420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dee00871-f2e0-4208-9266-a064ab9b4a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11283f740>]}
[0m16:06:38.961860 [info ] [MainThread]: Found 4 models, 6 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:06:38.962672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dee00871-f2e0-4208-9266-a064ab9b4a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266eba0>]}
[0m16:06:38.965053 [info ] [MainThread]: 
[0m16:06:38.966609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:38.968945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:06:38.989622 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:06:38.990510 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:06:38.991242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:39.110742 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:06:39.111397 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:06:39.112133 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:06:39.117421 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:06:39.121919 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:06:39.133282 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:06:39.142921 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:39.143514 [debug] [MainThread]: On master: BEGIN
[0m16:06:39.143998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:39.167426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:06:39.168783 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:39.169822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:39.180022 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:06:39.184850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dee00871-f2e0-4208-9266-a064ab9b4a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11283f470>]}
[0m16:06:39.185933 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:39.187898 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:39.188881 [debug] [MainThread]: On master: BEGIN
[0m16:06:39.191808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:06:39.192924 [debug] [MainThread]: On master: COMMIT
[0m16:06:39.193906 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:39.194779 [debug] [MainThread]: On master: COMMIT
[0m16:06:39.196609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:06:39.197603 [debug] [MainThread]: On master: Close
[0m16:06:39.199886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:39.201901 [info ] [MainThread]: 
[0m16:06:39.208877 [debug] [Thread-1 (]: Began running node test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:39.209819 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_sales_sale_id ................................... [RUN]
[0m16:06:39.210997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929)
[0m16:06:39.211648 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:39.265404 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:39.269813 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929 (compile): 16:06:39.212077 => 16:06:39.268525
[0m16:06:39.271009 [debug] [Thread-1 (]: Began executing node test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:39.312011 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:39.315846 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:39.317166 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929: BEGIN
[0m16:06:39.318289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:39.348799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:06:39.350153 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929"
[0m16:06:39.351526 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "postgres"."public"."stg_sales"
where sale_id is null



      
    ) dbt_internal_test
[0m16:06:39.363289 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:06:39.370361 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929 (execute): 16:06:39.271625 => 16:06:39.369652
[0m16:06:39.371923 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929: ROLLBACK
[0m16:06:39.374907 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929: Close
[0m16:06:39.379008 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_sales_sale_id ......................................... [[32mPASS[0m in 0.17s]
[0m16:06:39.382134 [debug] [Thread-1 (]: Finished running node test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929
[0m16:06:39.384502 [debug] [Thread-1 (]: Began running node test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:39.386464 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_sales_sale_id ..................................... [RUN]
[0m16:06:39.389806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tp_dbt.not_null_stg_sales_sale_id.6b07c53929, now test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521)
[0m16:06:39.392769 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:39.422884 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:39.433087 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521 (compile): 16:06:39.393964 => 16:06:39.431531
[0m16:06:39.435702 [debug] [Thread-1 (]: Began executing node test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:39.451758 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:39.456732 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:39.459864 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521: BEGIN
[0m16:06:39.461434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:39.508787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:06:39.510122 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521"
[0m16:06:39.511586 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sale_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_sales"
where sale_id is not null
group by sale_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:39.515937 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:06:39.519675 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521 (execute): 16:06:39.437170 => 16:06:39.519136
[0m16:06:39.520481 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521: ROLLBACK
[0m16:06:39.522474 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521: Close
[0m16:06:39.525552 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_sales_sale_id ........................................... [[32mPASS[0m in 0.14s]
[0m16:06:39.528037 [debug] [Thread-1 (]: Finished running node test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521
[0m16:06:39.532834 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:39.534345 [debug] [MainThread]: On master: BEGIN
[0m16:06:39.535347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:39.573623 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:06:39.574838 [debug] [MainThread]: On master: COMMIT
[0m16:06:39.576537 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:39.578102 [debug] [MainThread]: On master: COMMIT
[0m16:06:39.579886 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:06:39.580891 [debug] [MainThread]: On master: Close
[0m16:06:39.583000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:39.584129 [debug] [MainThread]: Connection 'test.tp_dbt.unique_stg_sales_sale_id.8a4f7c9521' was properly closed.
[0m16:06:39.585967 [info ] [MainThread]: 
[0m16:06:39.587728 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m16:06:39.590369 [debug] [MainThread]: Command end result
[0m16:06:39.608019 [info ] [MainThread]: 
[0m16:06:39.609797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:39.611366 [info ] [MainThread]: 
[0m16:06:39.613264 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:06:39.619858 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.239708, "process_user_time": 5.800842, "process_kernel_time": 0.741692, "process_mem_max_rss": "106360832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:06:39.621894 [debug] [MainThread]: Command `dbt test` succeeded at 16:06:39.621452 after 2.24 seconds
[0m16:06:39.623156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fa0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113004950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f264b0>]}
[0m16:06:39.623984 [debug] [MainThread]: Flushing usage events
[0m16:10:11.356072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d782720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7adfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7adca0>]}


============================== 16:10:11.367707 | 646152fc-5bff-4012-9d83-0b202ca8a6b0 ==============================
[0m16:10:11.367707 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:10:11.369323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select stg_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:11.910807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '646152fc-5bff-4012-9d83-0b202ca8a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d74e390>]}
[0m16:10:12.138241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '646152fc-5bff-4012-9d83-0b202ca8a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dddd2b0>]}
[0m16:10:12.140770 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:10:12.215584 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:10:12.352329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:10:12.353689 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/staging/models2.yml
[0m16:10:12.709795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '646152fc-5bff-4012-9d83-0b202ca8a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e548ad0>]}
[0m16:10:12.737955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '646152fc-5bff-4012-9d83-0b202ca8a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e361520>]}
[0m16:10:12.739159 [info ] [MainThread]: Found 4 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:10:12.740391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '646152fc-5bff-4012-9d83-0b202ca8a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5260f0>]}
[0m16:10:12.744240 [info ] [MainThread]: 
[0m16:10:12.747504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:12.758497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:10:12.807122 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:10:12.808383 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:10:12.809757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:12.941787 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:10:12.942497 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:10:12.943040 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:10:12.947732 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:10:12.950196 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:10:12.951536 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:10:12.959816 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.960400 [debug] [MainThread]: On master: BEGIN
[0m16:10:12.960874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:12.980638 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:12.981311 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.981942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:12.988368 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:10:12.991578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '646152fc-5bff-4012-9d83-0b202ca8a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e361f10>]}
[0m16:10:12.992282 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:12.993591 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.994286 [debug] [MainThread]: On master: BEGIN
[0m16:10:12.996330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:12.997004 [debug] [MainThread]: On master: COMMIT
[0m16:10:12.997603 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:12.998105 [debug] [MainThread]: On master: COMMIT
[0m16:10:12.999418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:13.000027 [debug] [MainThread]: On master: Close
[0m16:10:13.001249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:13.001906 [info ] [MainThread]: 
[0m16:10:13.006645 [debug] [Thread-1 (]: Began running node test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc
[0m16:10:13.007364 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_products_sale_id ................................ [RUN]
[0m16:10:13.008648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc)
[0m16:10:13.009832 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc
[0m16:10:13.040587 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc"
[0m16:10:13.042172 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc (compile): 16:10:13.010320 => 16:10:13.041759
[0m16:10:13.042823 [debug] [Thread-1 (]: Began executing node test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc
[0m16:10:13.085367 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc"
[0m16:10:13.088999 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc"
[0m16:10:13.091072 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc: BEGIN
[0m16:10:13.093197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:13.125124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:13.126364 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc"
[0m16:10:13.127479 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "postgres"."public"."stg_products"
where sale_id is null



      
    ) dbt_internal_test
[0m16:10:13.132368 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sale_id" does not exist
LINE 13: select sale_id
                ^

[0m16:10:13.133419 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc: ROLLBACK
[0m16:10:13.136129 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc (execute): 16:10:13.043270 => 16:10:13.135429
[0m16:10:13.137235 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc: Close
[0m16:10:13.159504 [debug] [Thread-1 (]: Database Error in test not_null_stg_products_sale_id (models/staging/models2.yml)
  column "sale_id" does not exist
  LINE 13: select sale_id
                  ^
  compiled Code at target/run/tp_dbt/models/staging/models2.yml/not_null_stg_products_sale_id.sql
[0m16:10:13.168585 [error] [Thread-1 (]: 1 of 2 ERROR not_null_stg_products_sale_id ..................................... [[31mERROR[0m in 0.15s]
[0m16:10:13.170635 [debug] [Thread-1 (]: Finished running node test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc
[0m16:10:13.172035 [debug] [Thread-1 (]: Began running node test.tp_dbt.unique_stg_products_sale_id.42d61d00b3
[0m16:10:13.173209 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_products_sale_id .................................. [RUN]
[0m16:10:13.176730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tp_dbt.not_null_stg_products_sale_id.e6346e1adc, now test.tp_dbt.unique_stg_products_sale_id.42d61d00b3)
[0m16:10:13.178560 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.unique_stg_products_sale_id.42d61d00b3
[0m16:10:13.205784 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.unique_stg_products_sale_id.42d61d00b3"
[0m16:10:13.208747 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_products_sale_id.42d61d00b3 (compile): 16:10:13.180714 => 16:10:13.207234
[0m16:10:13.209863 [debug] [Thread-1 (]: Began executing node test.tp_dbt.unique_stg_products_sale_id.42d61d00b3
[0m16:10:13.220555 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.unique_stg_products_sale_id.42d61d00b3"
[0m16:10:13.222636 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_products_sale_id.42d61d00b3"
[0m16:10:13.223930 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_sale_id.42d61d00b3: BEGIN
[0m16:10:13.225467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:13.256970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:13.260536 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_products_sale_id.42d61d00b3"
[0m16:10:13.261482 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_sale_id.42d61d00b3: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.unique_stg_products_sale_id.42d61d00b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sale_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_products"
where sale_id is not null
group by sale_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:13.264254 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sale_id" does not exist
LINE 12:     sale_id as unique_field,
             ^

[0m16:10:13.265120 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_sale_id.42d61d00b3: ROLLBACK
[0m16:10:13.267572 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_products_sale_id.42d61d00b3 (execute): 16:10:13.210490 => 16:10:13.266742
[0m16:10:13.268615 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_sale_id.42d61d00b3: Close
[0m16:10:13.275425 [debug] [Thread-1 (]: Database Error in test unique_stg_products_sale_id (models/staging/models2.yml)
  column "sale_id" does not exist
  LINE 12:     sale_id as unique_field,
               ^
  compiled Code at target/run/tp_dbt/models/staging/models2.yml/unique_stg_products_sale_id.sql
[0m16:10:13.276730 [error] [Thread-1 (]: 2 of 2 ERROR unique_stg_products_sale_id ....................................... [[31mERROR[0m in 0.10s]
[0m16:10:13.278174 [debug] [Thread-1 (]: Finished running node test.tp_dbt.unique_stg_products_sale_id.42d61d00b3
[0m16:10:13.281703 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:13.282585 [debug] [MainThread]: On master: BEGIN
[0m16:10:13.283662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:13.320090 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:13.321506 [debug] [MainThread]: On master: COMMIT
[0m16:10:13.322724 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:13.324586 [debug] [MainThread]: On master: COMMIT
[0m16:10:13.326640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:13.328029 [debug] [MainThread]: On master: Close
[0m16:10:13.330148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:13.331219 [debug] [MainThread]: Connection 'test.tp_dbt.unique_stg_products_sale_id.42d61d00b3' was properly closed.
[0m16:10:13.332462 [info ] [MainThread]: 
[0m16:10:13.333627 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:10:13.336113 [debug] [MainThread]: Command end result
[0m16:10:13.357941 [info ] [MainThread]: 
[0m16:10:13.359186 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:10:13.360684 [info ] [MainThread]: 
[0m16:10:13.362430 [error] [MainThread]:   Database Error in test not_null_stg_products_sale_id (models/staging/models2.yml)
  column "sale_id" does not exist
  LINE 13: select sale_id
                  ^
  compiled Code at target/run/tp_dbt/models/staging/models2.yml/not_null_stg_products_sale_id.sql
[0m16:10:13.364620 [info ] [MainThread]: 
[0m16:10:13.366490 [error] [MainThread]:   Database Error in test unique_stg_products_sale_id (models/staging/models2.yml)
  column "sale_id" does not exist
  LINE 12:     sale_id as unique_field,
               ^
  compiled Code at target/run/tp_dbt/models/staging/models2.yml/unique_stg_products_sale_id.sql
[0m16:10:13.367639 [info ] [MainThread]: 
[0m16:10:13.368973 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:10:13.380000 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.1400528, "process_user_time": 5.56286, "process_kernel_time": 0.750513, "process_mem_max_rss": "107188224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:10:13.381755 [debug] [MainThread]: Command `dbt test` failed at 16:10:13.381358 after 2.15 seconds
[0m16:10:13.383725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7adfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e575970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4567b0>]}
[0m16:10:13.386336 [debug] [MainThread]: Flushing usage events
[0m16:10:38.939843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0fb8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2eddf0>]}


============================== 16:10:38.952992 | aa40e553-b9f3-4532-93d7-32da59b8f439 ==============================
[0m16:10:38.952992 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:10:38.954555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_products', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:39.495153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa40e553-b9f3-4532-93d7-32da59b8f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf1e80>]}
[0m16:10:39.701841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa40e553-b9f3-4532-93d7-32da59b8f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a955580>]}
[0m16:10:39.704358 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:10:39.751865 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:10:39.865908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:10:39.867761 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/staging/models2.yml
[0m16:10:40.533772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa40e553-b9f3-4532-93d7-32da59b8f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a7a10>]}
[0m16:10:40.550847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa40e553-b9f3-4532-93d7-32da59b8f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae58050>]}
[0m16:10:40.551587 [info ] [MainThread]: Found 4 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:10:40.552229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa40e553-b9f3-4532-93d7-32da59b8f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b165310>]}
[0m16:10:40.554852 [info ] [MainThread]: 
[0m16:10:40.556195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:40.558932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:10:40.579234 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:10:40.579868 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:10:40.580597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:40.705964 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:10:40.707158 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:10:40.708338 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:10:40.715987 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:10:40.720338 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:10:40.722802 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:10:40.738648 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:40.739893 [debug] [MainThread]: On master: BEGIN
[0m16:10:40.741335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:40.783900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:40.785066 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:40.786228 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:40.797576 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:10:40.803714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa40e553-b9f3-4532-93d7-32da59b8f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae76510>]}
[0m16:10:40.805086 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:40.807074 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:40.808171 [debug] [MainThread]: On master: BEGIN
[0m16:10:40.811488 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:40.812774 [debug] [MainThread]: On master: COMMIT
[0m16:10:40.813622 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:40.814412 [debug] [MainThread]: On master: COMMIT
[0m16:10:40.816187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:40.817176 [debug] [MainThread]: On master: Close
[0m16:10:40.819490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:40.820687 [info ] [MainThread]: 
[0m16:10:40.827230 [debug] [Thread-1 (]: Began running node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:10:40.828024 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_products_product_id ............................. [RUN]
[0m16:10:40.829152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now test.tp_dbt.not_null_stg_products_product_id.6373b0acf3)
[0m16:10:40.829885 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:10:40.889482 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:10:40.891902 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_products_product_id.6373b0acf3 (compile): 16:10:40.830328 => 16:10:40.891116
[0m16:10:40.893426 [debug] [Thread-1 (]: Began executing node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:10:40.934939 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:10:40.936902 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:10:40.938226 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m16:10:40.939574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:40.971448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:40.972844 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:10:40.974259 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "postgres"."public"."stg_products"
where product_id is null



      
    ) dbt_internal_test
[0m16:10:40.977743 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:10:40.982425 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_products_product_id.6373b0acf3 (execute): 16:10:40.894624 => 16:10:40.981799
[0m16:10:40.983337 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m16:10:40.985453 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: Close
[0m16:10:40.988995 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_products_product_id ................................... [[32mPASS[0m in 0.16s]
[0m16:10:40.990700 [debug] [Thread-1 (]: Finished running node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:10:40.991786 [debug] [Thread-1 (]: Began running node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:10:40.992742 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_products_product_id ............................... [RUN]
[0m16:10:40.994432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tp_dbt.not_null_stg_products_product_id.6373b0acf3, now test.tp_dbt.unique_stg_products_product_id.7d950a1467)
[0m16:10:40.995571 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:10:41.009406 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:10:41.011793 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_products_product_id.7d950a1467 (compile): 16:10:40.996113 => 16:10:41.010918
[0m16:10:41.012894 [debug] [Thread-1 (]: Began executing node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:10:41.018979 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:10:41.020852 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:10:41.022038 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: BEGIN
[0m16:10:41.023016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:41.054806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:41.056037 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:10:41.057170 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:41.061308 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:10:41.064829 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_products_product_id.7d950a1467 (execute): 16:10:41.013437 => 16:10:41.064301
[0m16:10:41.065986 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m16:10:41.068148 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: Close
[0m16:10:41.070941 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_products_product_id ..................................... [[32mPASS[0m in 0.08s]
[0m16:10:41.072913 [debug] [Thread-1 (]: Finished running node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:10:41.077185 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:41.078029 [debug] [MainThread]: On master: BEGIN
[0m16:10:41.078676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:41.111654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:41.112922 [debug] [MainThread]: On master: COMMIT
[0m16:10:41.113723 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:41.114513 [debug] [MainThread]: On master: COMMIT
[0m16:10:41.117196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:41.118252 [debug] [MainThread]: On master: Close
[0m16:10:41.120297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:41.121341 [debug] [MainThread]: Connection 'test.tp_dbt.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m16:10:41.122516 [info ] [MainThread]: 
[0m16:10:41.123908 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:10:41.126242 [debug] [MainThread]: Command end result
[0m16:10:41.149779 [info ] [MainThread]: 
[0m16:10:41.151412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:41.152451 [info ] [MainThread]: 
[0m16:10:41.153714 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:10:41.159379 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.3534052, "process_user_time": 5.97518, "process_kernel_time": 0.708075, "process_mem_max_rss": "109953024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:10:41.163144 [debug] [MainThread]: Command `dbt test` succeeded at 16:10:41.162265 after 2.36 seconds
[0m16:10:41.164603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a157e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0285f0>]}
[0m16:10:41.166006 [debug] [MainThread]: Flushing usage events
[0m16:19:24.872623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be36030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be35d30>]}


============================== 16:19:24.885221 | 12040bde-ef29-447f-a48c-4affab544123 ==============================
[0m16:19:24.885221 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:19:24.886811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_products stg_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:19:25.462160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12040bde-ef29-447f-a48c-4affab544123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d0320>]}
[0m16:19:25.694743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12040bde-ef29-447f-a48c-4affab544123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0c470>]}
[0m16:19:25.697671 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:19:25.793533 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:19:25.929360 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 0 files changed.
[0m16:19:25.930855 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/staging/stg_products.sql
[0m16:19:25.932060 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/marts/daily_sales_volume.sql
[0m16:19:25.933641 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/marts/daily_sales_revenue_by_category.sql
[0m16:19:25.934751 [debug] [MainThread]: Partial parsing: added file: tp_dbt://models/staging/stg_sales.sql
[0m16:19:25.935850 [debug] [MainThread]: Partial parsing: deleted file: tp_dbt://models/example/stg_sales.sql
[0m16:19:25.936764 [debug] [MainThread]: Partial parsing: deleted file: tp_dbt://models/example/stg_products.sql
[0m16:19:26.644207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12040bde-ef29-447f-a48c-4affab544123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cba72f0>]}
[0m16:19:26.676079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12040bde-ef29-447f-a48c-4affab544123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bfd10>]}
[0m16:19:26.677341 [info ] [MainThread]: Found 6 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:19:26.678730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12040bde-ef29-447f-a48c-4affab544123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb17b30>]}
[0m16:19:26.683966 [info ] [MainThread]: 
[0m16:19:26.688263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:26.696284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:19:26.762432 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:19:26.765845 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:19:26.767308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:26.930043 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.931055 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:19:26.932064 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:19:26.940753 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:19:26.945264 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:19:26.947455 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:19:26.962158 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.963264 [debug] [MainThread]: On master: BEGIN
[0m16:19:26.964179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:27.001025 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:27.002014 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:27.003340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:27.013974 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:19:27.018966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12040bde-ef29-447f-a48c-4affab544123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bfe90>]}
[0m16:19:27.020130 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:27.022244 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:27.023372 [debug] [MainThread]: On master: BEGIN
[0m16:19:27.026334 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:27.027407 [debug] [MainThread]: On master: COMMIT
[0m16:19:27.028318 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:27.029201 [debug] [MainThread]: On master: COMMIT
[0m16:19:27.031016 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:27.032043 [debug] [MainThread]: On master: Close
[0m16:19:27.034384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:27.036298 [info ] [MainThread]: 
[0m16:19:27.063107 [debug] [Thread-1 (]: Began running node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:19:27.064595 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_products_product_id ............................. [RUN]
[0m16:19:27.068455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now test.tp_dbt.not_null_stg_products_product_id.6373b0acf3)
[0m16:19:27.070197 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:19:27.158972 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:19:27.164801 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_products_product_id.6373b0acf3 (compile): 16:19:27.071595 => 16:19:27.164209
[0m16:19:27.165863 [debug] [Thread-1 (]: Began executing node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:19:27.209390 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:19:27.212382 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:19:27.213365 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m16:19:27.214237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:27.243893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:19:27.245063 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m16:19:27.246181 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "postgres"."public"."stg_products"
where product_id is null



      
    ) dbt_internal_test
[0m16:19:27.251477 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:27.268903 [debug] [Thread-1 (]: Timing info for test.tp_dbt.not_null_stg_products_product_id.6373b0acf3 (execute): 16:19:27.167325 => 16:19:27.268129
[0m16:19:27.269975 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m16:19:27.272162 [debug] [Thread-1 (]: On test.tp_dbt.not_null_stg_products_product_id.6373b0acf3: Close
[0m16:19:27.277613 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_products_product_id ................................... [[32mPASS[0m in 0.21s]
[0m16:19:27.280152 [debug] [Thread-1 (]: Finished running node test.tp_dbt.not_null_stg_products_product_id.6373b0acf3
[0m16:19:27.281727 [debug] [Thread-1 (]: Began running node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:19:27.283570 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_products_product_id ............................... [RUN]
[0m16:19:27.299679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tp_dbt.not_null_stg_products_product_id.6373b0acf3, now test.tp_dbt.unique_stg_products_product_id.7d950a1467)
[0m16:19:27.301505 [debug] [Thread-1 (]: Began compiling node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:19:27.328294 [debug] [Thread-1 (]: Writing injected SQL for node "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:19:27.331226 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_products_product_id.7d950a1467 (compile): 16:19:27.302635 => 16:19:27.330296
[0m16:19:27.332656 [debug] [Thread-1 (]: Began executing node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:19:27.342307 [debug] [Thread-1 (]: Writing runtime sql for node "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:19:27.344342 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:19:27.346399 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: BEGIN
[0m16:19:27.347568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:27.380201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:19:27.381812 [debug] [Thread-1 (]: Using postgres connection "test.tp_dbt.unique_stg_products_product_id.7d950a1467"
[0m16:19:27.383058 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "test.tp_dbt.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:19:27.387400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:27.394446 [debug] [Thread-1 (]: Timing info for test.tp_dbt.unique_stg_products_product_id.7d950a1467 (execute): 16:19:27.333532 => 16:19:27.393554
[0m16:19:27.396088 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m16:19:27.399188 [debug] [Thread-1 (]: On test.tp_dbt.unique_stg_products_product_id.7d950a1467: Close
[0m16:19:27.403318 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_products_product_id ..................................... [[32mPASS[0m in 0.11s]
[0m16:19:27.408619 [debug] [Thread-1 (]: Finished running node test.tp_dbt.unique_stg_products_product_id.7d950a1467
[0m16:19:27.411801 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:27.412708 [debug] [MainThread]: On master: BEGIN
[0m16:19:27.413639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:27.459377 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:27.460774 [debug] [MainThread]: On master: COMMIT
[0m16:19:27.462834 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:27.463855 [debug] [MainThread]: On master: COMMIT
[0m16:19:27.466058 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:27.467152 [debug] [MainThread]: On master: Close
[0m16:19:27.469280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:27.470189 [debug] [MainThread]: Connection 'test.tp_dbt.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m16:19:27.471894 [info ] [MainThread]: 
[0m16:19:27.473217 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m16:19:27.475658 [debug] [MainThread]: Command end result
[0m16:19:27.504324 [info ] [MainThread]: 
[0m16:19:27.505652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:27.506949 [info ] [MainThread]: 
[0m16:19:27.508158 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:19:27.514549 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7814794, "process_user_time": 6.468721, "process_kernel_time": 0.818868, "process_mem_max_rss": "108670976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:19:27.516314 [debug] [MainThread]: Command `dbt test` succeeded at 16:19:27.515938 after 2.78 seconds
[0m16:19:27.519031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc40410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bedee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd65d60>]}
[0m16:19:27.520300 [debug] [MainThread]: Flushing usage events
[0m16:22:25.935122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130b0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ddca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130dd9a0>]}


============================== 16:22:25.948509 | 5062c5a2-e222-4559-a65a-5ba88745514c ==============================
[0m16:22:25.948509 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:22:25.950136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:22:26.476273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5062c5a2-e222-4559-a65a-5ba88745514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113672510>]}
[0m16:22:26.691109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5062c5a2-e222-4559-a65a-5ba88745514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f23260>]}
[0m16:22:26.694176 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:22:26.769479 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:22:26.895896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:22:26.896826 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/marts/daily_sales_revenue_by_category.sql
[0m16:22:27.167078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5062c5a2-e222-4559-a65a-5ba88745514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113edf800>]}
[0m16:22:27.195422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5062c5a2-e222-4559-a65a-5ba88745514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c3cfb0>]}
[0m16:22:27.196592 [info ] [MainThread]: Found 6 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:22:27.197632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5062c5a2-e222-4559-a65a-5ba88745514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c3cdd0>]}
[0m16:22:27.201125 [info ] [MainThread]: 
[0m16:22:27.203215 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:27.205941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:22:27.229585 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:22:27.231381 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:22:27.232317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:27.383007 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:22:27.386632 [debug] [ThreadPool]: On list_postgres: Close
[0m16:22:27.391734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:22:27.407010 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:22:27.407936 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:22:27.408913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:27.438329 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:22:27.439424 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:22:27.440495 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:22:27.447623 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:22:27.450989 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:22:27.452934 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:22:27.466287 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:27.467387 [debug] [MainThread]: On master: BEGIN
[0m16:22:27.468292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:27.498741 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:22:27.500607 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:27.501752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:27.512427 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:22:27.517114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5062c5a2-e222-4559-a65a-5ba88745514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ecbc20>]}
[0m16:22:27.518311 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:27.520399 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:27.521440 [debug] [MainThread]: On master: BEGIN
[0m16:22:27.524953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:22:27.525685 [debug] [MainThread]: On master: COMMIT
[0m16:22:27.526306 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:27.526897 [debug] [MainThread]: On master: COMMIT
[0m16:22:27.529411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:22:27.530513 [debug] [MainThread]: On master: Close
[0m16:22:27.532686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:27.533596 [info ] [MainThread]: 
[0m16:22:27.539527 [debug] [Thread-1 (]: Began running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:22:27.540865 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:22:27.542900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.daily_sales_revenue_by_category)
[0m16:22:27.543954 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.daily_sales_revenue_by_category
[0m16:22:27.558377 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:22:27.563598 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (compile): 16:22:27.544642 => 16:22:27.562312
[0m16:22:27.565061 [debug] [Thread-1 (]: Began executing node model.tp_dbt.daily_sales_revenue_by_category
[0m16:22:27.676607 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:22:27.681006 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:22:27.682429 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: BEGIN
[0m16:22:27.684532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:27.763029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:22:27.769513 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:22:27.775037 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    category,
    sum(quantity * price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p on product_id = product_id
group by sale_date, category;
  );
  
[0m16:22:27.791064 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: group by sale_date, category;
                                     ^

[0m16:22:27.792395 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: ROLLBACK
[0m16:22:27.796153 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (execute): 16:22:27.565590 => 16:22:27.795477
[0m16:22:27.800687 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: Close
[0m16:22:27.828639 [debug] [Thread-1 (]: Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 20: group by sale_date, category;
                                       ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:22:27.830124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5062c5a2-e222-4559-a65a-5ba88745514c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ebc050>]}
[0m16:22:27.832712 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.29s]
[0m16:22:27.834923 [debug] [Thread-1 (]: Finished running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:22:27.839114 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:27.840082 [debug] [MainThread]: On master: BEGIN
[0m16:22:27.840794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:27.876988 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:22:27.878590 [debug] [MainThread]: On master: COMMIT
[0m16:22:27.880395 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:27.881282 [debug] [MainThread]: On master: COMMIT
[0m16:22:27.883434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:22:27.884727 [debug] [MainThread]: On master: Close
[0m16:22:27.886732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:27.887703 [debug] [MainThread]: Connection 'model.tp_dbt.daily_sales_revenue_by_category' was properly closed.
[0m16:22:27.888689 [info ] [MainThread]: 
[0m16:22:27.890087 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m16:22:27.891894 [debug] [MainThread]: Command end result
[0m16:22:27.915237 [info ] [MainThread]: 
[0m16:22:27.915977 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:22:27.916576 [info ] [MainThread]: 
[0m16:22:27.917227 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 20: group by sale_date, category;
                                       ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:22:27.917878 [info ] [MainThread]: 
[0m16:22:27.918780 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:22:27.924794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.135565, "process_user_time": 5.82518, "process_kernel_time": 0.754223, "process_mem_max_rss": "107675648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:22:27.929000 [debug] [MainThread]: Command `dbt run` failed at 16:22:27.928598 after 2.14 seconds
[0m16:22:27.934296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122a0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113180c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113df2480>]}
[0m16:22:27.935008 [debug] [MainThread]: Flushing usage events
[0m16:28:35.813785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ecce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1da90>]}


============================== 16:28:35.827834 | 59f09f48-c499-41b2-91d0-4717090b461c ==============================
[0m16:28:35.827834 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:28:35.830457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:28:36.377437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f09f48-c499-41b2-91d0-4717090b461c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf4eba0>]}
[0m16:28:36.604256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f09f48-c499-41b2-91d0-4717090b461c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfad7f0>]}
[0m16:28:36.607249 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:28:36.655179 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:28:36.781236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:28:36.782383 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/marts/daily_sales_revenue_by_category.sql
[0m16:28:37.127646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f09f48-c499-41b2-91d0-4717090b461c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d81f470>]}
[0m16:28:37.153848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f09f48-c499-41b2-91d0-4717090b461c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5d4770>]}
[0m16:28:37.155297 [info ] [MainThread]: Found 6 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:28:37.156778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f09f48-c499-41b2-91d0-4717090b461c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d730260>]}
[0m16:28:37.160501 [info ] [MainThread]: 
[0m16:28:37.163677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:37.166712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:28:37.190655 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:28:37.191817 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:28:37.192885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:37.315803 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:28:37.318871 [debug] [ThreadPool]: On list_postgres: Close
[0m16:28:37.323494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:28:37.336843 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:28:37.337813 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:28:37.338632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:37.366681 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:28:37.367637 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:28:37.368549 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:28:37.376052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:28:37.379521 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:28:37.381666 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:28:37.393661 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:37.394629 [debug] [MainThread]: On master: BEGIN
[0m16:28:37.395495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:37.422216 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:37.423425 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:37.424887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:37.434589 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:28:37.438599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f09f48-c499-41b2-91d0-4717090b461c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7105c0>]}
[0m16:28:37.439565 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:37.441526 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:37.442539 [debug] [MainThread]: On master: BEGIN
[0m16:28:37.445223 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:37.446627 [debug] [MainThread]: On master: COMMIT
[0m16:28:37.447622 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:37.448544 [debug] [MainThread]: On master: COMMIT
[0m16:28:37.450172 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:37.451036 [debug] [MainThread]: On master: Close
[0m16:28:37.453081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:28:37.454357 [info ] [MainThread]: 
[0m16:28:37.459488 [debug] [Thread-1 (]: Began running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:28:37.460853 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:28:37.462480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.daily_sales_revenue_by_category)
[0m16:28:37.463337 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.daily_sales_revenue_by_category
[0m16:28:37.479013 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:28:37.480822 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (compile): 16:28:37.463805 => 16:28:37.480112
[0m16:28:37.482147 [debug] [Thread-1 (]: Began executing node model.tp_dbt.daily_sales_revenue_by_category
[0m16:28:37.588229 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:28:37.590125 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:28:37.591193 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: BEGIN
[0m16:28:37.591960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:37.621084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:37.623078 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:28:37.624360 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    category,
    sum(quantity * price) as daily_revenue
from "postgres"."public"."stg_sales" 
join "postgres"."public"."stg_products" 
    on product_id = product_id
group by sale_date, category;
  );
  
[0m16:28:37.628624 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: group by sale_date, category;
                                     ^

[0m16:28:37.629701 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: ROLLBACK
[0m16:28:37.632129 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (execute): 16:28:37.483104 => 16:28:37.631473
[0m16:28:37.633186 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: Close
[0m16:28:37.656445 [debug] [Thread-1 (]: Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by sale_date, category;
                                       ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:28:37.657942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f09f48-c499-41b2-91d0-4717090b461c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7fc410>]}
[0m16:28:37.659480 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.20s]
[0m16:28:37.661894 [debug] [Thread-1 (]: Finished running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:28:37.665726 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:37.666692 [debug] [MainThread]: On master: BEGIN
[0m16:28:37.668021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:37.821343 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:37.823094 [debug] [MainThread]: On master: COMMIT
[0m16:28:37.824227 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:37.827621 [debug] [MainThread]: On master: COMMIT
[0m16:28:37.831363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:37.834223 [debug] [MainThread]: On master: Close
[0m16:28:37.836710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:37.837681 [debug] [MainThread]: Connection 'model.tp_dbt.daily_sales_revenue_by_category' was properly closed.
[0m16:28:37.838719 [info ] [MainThread]: 
[0m16:28:37.839833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:28:37.844254 [debug] [MainThread]: Command end result
[0m16:28:37.889142 [info ] [MainThread]: 
[0m16:28:37.891955 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:28:37.893714 [info ] [MainThread]: 
[0m16:28:37.897257 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by sale_date, category;
                                       ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:28:37.905671 [info ] [MainThread]: 
[0m16:28:37.907024 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:28:37.916887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2497735, "process_user_time": 5.75764, "process_kernel_time": 0.743898, "process_mem_max_rss": "108109824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:28:37.918778 [debug] [MainThread]: Command `dbt run` failed at 16:28:37.918312 after 2.25 seconds
[0m16:28:37.920037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1db50>]}
[0m16:28:37.921277 [debug] [MainThread]: Flushing usage events
[0m16:34:01.959685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9ee090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da19e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da19b20>]}


============================== 16:34:01.972256 | 9987d46a-2a4a-4faa-87d6-6d416dccb83f ==============================
[0m16:34:01.972256 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:34:01.974161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'send_anonymous_usage_stats': 'True'}
[0m16:34:02.512503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9987d46a-2a4a-4faa-87d6-6d416dccb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9d2b0>]}
[0m16:34:02.792644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9987d46a-2a4a-4faa-87d6-6d416dccb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da51670>]}
[0m16:34:02.797640 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:34:02.877061 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:34:03.070971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:03.072093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:03.094172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9987d46a-2a4a-4faa-87d6-6d416dccb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfdf6e0>]}
[0m16:34:03.135583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9987d46a-2a4a-4faa-87d6-6d416dccb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d51f0>]}
[0m16:34:03.137721 [info ] [MainThread]: Found 6 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:34:03.140127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9987d46a-2a4a-4faa-87d6-6d416dccb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df10d40>]}
[0m16:34:03.145958 [info ] [MainThread]: 
[0m16:34:03.149489 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:03.156710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:34:03.219977 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:34:03.221847 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:34:03.226103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:03.366344 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:34:03.370208 [debug] [ThreadPool]: On list_postgres: Close
[0m16:34:03.375910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:34:03.390639 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:34:03.391740 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:34:03.392691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:03.423243 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:34:03.424492 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:34:03.425637 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:34:03.435009 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:34:03.438371 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:34:03.440636 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:34:03.455953 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:03.456874 [debug] [MainThread]: On master: BEGIN
[0m16:34:03.457819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:03.503834 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:03.505566 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:03.506867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:03.520894 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:34:03.525681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9987d46a-2a4a-4faa-87d6-6d416dccb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df10d70>]}
[0m16:34:03.527497 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:03.530396 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:03.531804 [debug] [MainThread]: On master: BEGIN
[0m16:34:03.535420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:03.536551 [debug] [MainThread]: On master: COMMIT
[0m16:34:03.537612 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:03.538396 [debug] [MainThread]: On master: COMMIT
[0m16:34:03.540584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:34:03.541674 [debug] [MainThread]: On master: Close
[0m16:34:03.543981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:03.545434 [info ] [MainThread]: 
[0m16:34:03.551094 [debug] [Thread-1 (]: Began running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:03.552480 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:34:03.554397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.daily_sales_revenue_by_category)
[0m16:34:03.555276 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:03.577560 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:03.579561 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (compile): 16:34:03.555887 => 16:34:03.579057
[0m16:34:03.581336 [debug] [Thread-1 (]: Began executing node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:03.703592 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:03.707337 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:03.708471 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: BEGIN
[0m16:34:03.710011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:03.745959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:34:03.747233 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:03.748486 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    category,
    sum(quantity * price) as daily_revenue
from "postgres"."public"."stg_sales" 
join "postgres"."public"."stg_products" 
    on product_id = product_id
group by sale_date, category;
  );
  
[0m16:34:03.756968 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: group by sale_date, category;
                                     ^

[0m16:34:03.758308 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: ROLLBACK
[0m16:34:03.760804 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (execute): 16:34:03.582141 => 16:34:03.760062
[0m16:34:03.761718 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: Close
[0m16:34:03.780529 [debug] [Thread-1 (]: Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by sale_date, category;
                                       ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:34:03.781948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9987d46a-2a4a-4faa-87d6-6d416dccb83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e72b5f0>]}
[0m16:34:03.784961 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.23s]
[0m16:34:03.787131 [debug] [Thread-1 (]: Finished running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:03.791451 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:03.792547 [debug] [MainThread]: On master: BEGIN
[0m16:34:03.793443 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:03.838769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:03.840203 [debug] [MainThread]: On master: COMMIT
[0m16:34:03.841414 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:03.842587 [debug] [MainThread]: On master: COMMIT
[0m16:34:03.851487 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:34:03.852535 [debug] [MainThread]: On master: Close
[0m16:34:03.854479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:03.855561 [debug] [MainThread]: Connection 'model.tp_dbt.daily_sales_revenue_by_category' was properly closed.
[0m16:34:03.856913 [info ] [MainThread]: 
[0m16:34:03.858144 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m16:34:03.860058 [debug] [MainThread]: Command end result
[0m16:34:03.891015 [info ] [MainThread]: 
[0m16:34:03.892369 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:34:03.893993 [info ] [MainThread]: 
[0m16:34:03.895721 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  syntax error at or near ";"
  LINE 21: group by sale_date, category;
                                       ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:34:03.899168 [info ] [MainThread]: 
[0m16:34:03.902603 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:34:03.909127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0849886, "process_user_time": 5.539909, "process_kernel_time": 0.778577, "process_mem_max_rss": "105832448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:03.911363 [debug] [MainThread]: Command `dbt run` failed at 16:34:03.910879 after 2.09 seconds
[0m16:34:03.912902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da19cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da19c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75b320>]}
[0m16:34:03.914033 [debug] [MainThread]: Flushing usage events
[0m16:34:15.400344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080edf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080edaf0>]}


============================== 16:34:15.409185 | f571ead7-0134-4d09-9741-07f04e927e54 ==============================
[0m16:34:15.409185 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:34:15.411124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/estelleclement/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:15.830843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f571ead7-0134-4d09-9741-07f04e927e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e9b80>]}
[0m16:34:16.047214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f571ead7-0134-4d09-9741-07f04e927e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e67ce0>]}
[0m16:34:16.048891 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:34:16.114847 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:34:16.217427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:16.219030 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/marts/daily_sales_revenue_by_category.sql
[0m16:34:16.562236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f571ead7-0134-4d09-9741-07f04e927e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9f710>]}
[0m16:34:16.587732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f571ead7-0134-4d09-9741-07f04e927e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a4800>]}
[0m16:34:16.588989 [info ] [MainThread]: Found 6 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:34:16.590354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f571ead7-0134-4d09-9741-07f04e927e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c1190>]}
[0m16:34:16.594060 [info ] [MainThread]: 
[0m16:34:16.596982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:16.605244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:34:16.675036 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:34:16.675919 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:34:16.676718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:16.729977 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:34:16.733509 [debug] [ThreadPool]: On list_postgres: Close
[0m16:34:16.742488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:34:16.758957 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:34:16.759786 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:34:16.760507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:16.788774 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:34:16.789714 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:34:16.790486 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:34:16.798201 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:34:16.801945 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:34:16.804088 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:34:16.819431 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.820378 [debug] [MainThread]: On master: BEGIN
[0m16:34:16.821413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:16.851157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:16.852894 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.853919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:16.866168 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:34:16.870521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f571ead7-0134-4d09-9741-07f04e927e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e03f20>]}
[0m16:34:16.871588 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:16.873610 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.874638 [debug] [MainThread]: On master: BEGIN
[0m16:34:16.877973 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:16.878986 [debug] [MainThread]: On master: COMMIT
[0m16:34:16.879850 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:16.880703 [debug] [MainThread]: On master: COMMIT
[0m16:34:16.882694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:34:16.883593 [debug] [MainThread]: On master: Close
[0m16:34:16.886100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:16.887609 [info ] [MainThread]: 
[0m16:34:16.893105 [debug] [Thread-1 (]: Began running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:16.895435 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:34:16.897663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.daily_sales_revenue_by_category)
[0m16:34:16.899585 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:16.938965 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:16.950804 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (compile): 16:34:16.900700 => 16:34:16.949086
[0m16:34:16.952106 [debug] [Thread-1 (]: Began executing node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:17.072125 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:17.075702 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:17.076770 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: BEGIN
[0m16:34:17.077814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:17.106852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:34:17.108143 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:17.109472 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    category,
    sum(quantity * price) as daily_revenue
from "postgres"."public"."stg_sales" 
join "postgres"."public"."stg_products" 
    on product_id = product_id
group by sale_date, category
  );
  
[0m16:34:17.114239 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "product_id" is ambiguous
LINE 20:     on product_id = product_id
                ^

[0m16:34:17.115780 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: ROLLBACK
[0m16:34:17.118873 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (execute): 16:34:16.953320 => 16:34:17.118121
[0m16:34:17.119903 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: Close
[0m16:34:17.132031 [debug] [Thread-1 (]: Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  column reference "product_id" is ambiguous
  LINE 20:     on product_id = product_id
                  ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:34:17.133190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f571ead7-0134-4d09-9741-07f04e927e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed6e70>]}
[0m16:34:17.134752 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.daily_sales_revenue_by_category ... [[31mERROR[0m in 0.24s]
[0m16:34:17.137381 [debug] [Thread-1 (]: Finished running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:17.140442 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:17.141304 [debug] [MainThread]: On master: BEGIN
[0m16:34:17.142230 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:17.209374 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:17.210764 [debug] [MainThread]: On master: COMMIT
[0m16:34:17.211859 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:17.217529 [debug] [MainThread]: On master: COMMIT
[0m16:34:17.222432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:34:17.223747 [debug] [MainThread]: On master: Close
[0m16:34:17.227665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:17.229193 [debug] [MainThread]: Connection 'model.tp_dbt.daily_sales_revenue_by_category' was properly closed.
[0m16:34:17.230905 [info ] [MainThread]: 
[0m16:34:17.232596 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m16:34:17.238572 [debug] [MainThread]: Command end result
[0m16:34:17.253786 [info ] [MainThread]: 
[0m16:34:17.255368 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:34:17.256248 [info ] [MainThread]: 
[0m16:34:17.257106 [error] [MainThread]:   Database Error in model daily_sales_revenue_by_category (models/marts/daily_sales_revenue_by_category.sql)
  column reference "product_id" is ambiguous
  LINE 20:     on product_id = product_id
                  ^
  compiled Code at target/run/tp_dbt/models/marts/daily_sales_revenue_by_category.sql
[0m16:34:17.258022 [info ] [MainThread]: 
[0m16:34:17.259060 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:34:17.261411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0530674, "process_user_time": 5.465405, "process_kernel_time": 0.583766, "process_mem_max_rss": "107819008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:17.263050 [debug] [MainThread]: Command `dbt run` failed at 16:34:17.262630 after 2.05 seconds
[0m16:34:17.264449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080edcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f89ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c16a0>]}
[0m16:34:17.268778 [debug] [MainThread]: Flushing usage events
[0m16:34:56.580984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee5d00>]}


============================== 16:34:56.594798 | 82a33bbf-add1-4c69-80f3-391601ca5ac7 ==============================
[0m16:34:56.594798 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:34:56.596569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select daily_sales_revenue_by_category', 'send_anonymous_usage_stats': 'True'}
[0m16:34:57.112939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82a33bbf-add1-4c69-80f3-391601ca5ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae860c0>]}
[0m16:34:57.325370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82a33bbf-add1-4c69-80f3-391601ca5ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9aaff0>]}
[0m16:34:57.328288 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:34:57.389918 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:34:57.524346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:57.525817 [debug] [MainThread]: Partial parsing: updated file: tp_dbt://models/marts/daily_sales_revenue_by_category.sql
[0m16:34:57.917471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a33bbf-add1-4c69-80f3-391601ca5ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce7650>]}
[0m16:34:57.962547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a33bbf-add1-4c69-80f3-391601ca5ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba45b80>]}
[0m16:34:57.965148 [info ] [MainThread]: Found 6 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:34:57.966930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a33bbf-add1-4c69-80f3-391601ca5ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf8500>]}
[0m16:34:57.976534 [info ] [MainThread]: 
[0m16:34:57.982667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:57.990161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:34:58.017807 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:34:58.019918 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:34:58.021931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:58.146035 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:34:58.149464 [debug] [ThreadPool]: On list_postgres: Close
[0m16:34:58.154816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:34:58.166945 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:34:58.167876 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:34:58.168677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:58.195612 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:34:58.196549 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:34:58.197416 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:34:58.204763 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:34:58.207718 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:34:58.209646 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:34:58.222663 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:58.223701 [debug] [MainThread]: On master: BEGIN
[0m16:34:58.224567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:58.250909 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:58.252599 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:58.253840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:58.264483 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:34:58.269939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a33bbf-add1-4c69-80f3-391601ca5ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbfa300>]}
[0m16:34:58.272033 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:58.274144 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:58.275231 [debug] [MainThread]: On master: BEGIN
[0m16:34:58.278635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:58.279803 [debug] [MainThread]: On master: COMMIT
[0m16:34:58.280658 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:58.281939 [debug] [MainThread]: On master: COMMIT
[0m16:34:58.283854 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:34:58.284990 [debug] [MainThread]: On master: Close
[0m16:34:58.287449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:58.288981 [info ] [MainThread]: 
[0m16:34:58.296831 [debug] [Thread-1 (]: Began running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:58.299159 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_revenue_by_category ............ [RUN]
[0m16:34:58.301997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.daily_sales_revenue_by_category)
[0m16:34:58.304257 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:58.340681 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:58.349730 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (compile): 16:34:58.305448 => 16:34:58.348800
[0m16:34:58.351070 [debug] [Thread-1 (]: Began executing node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:58.470674 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:58.472954 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:58.474014 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: BEGIN
[0m16:34:58.475069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:58.505496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:34:58.506398 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:58.507317 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_revenue_by_category"} */

  
    

  create  table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp"
  
  
    as
  
  (
    

select
    s.sale_date,
    p.category,
    sum(s.quantity * p.price) as daily_revenue
from "postgres"."public"."stg_sales" s
join "postgres"."public"."stg_products" p on s.product_id = p.product_id
group by s.sale_date, p.category
  );
  
[0m16:34:58.548304 [debug] [Thread-1 (]: SQL status: SELECT 169 in 0.0 seconds
[0m16:34:58.560771 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:58.561729 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_revenue_by_category"} */
alter table "postgres"."public"."daily_sales_revenue_by_category__dbt_tmp" rename to "daily_sales_revenue_by_category"
[0m16:34:58.568171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:34:58.608686 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: COMMIT
[0m16:34:58.609788 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:58.610659 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: COMMIT
[0m16:34:58.618107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:34:58.631834 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."daily_sales_revenue_by_category__dbt_backup"
[0m16:34:58.644273 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_revenue_by_category"
[0m16:34:58.645408 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_revenue_by_category"} */
drop table if exists "postgres"."public"."daily_sales_revenue_by_category__dbt_backup" cascade
[0m16:34:58.647580 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:34:58.651367 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_revenue_by_category (execute): 16:34:58.356420 => 16:34:58.650720
[0m16:34:58.652457 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_revenue_by_category: Close
[0m16:34:58.654421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a33bbf-add1-4c69-80f3-391601ca5ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb84d0>]}
[0m16:34:58.656973 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.daily_sales_revenue_by_category ....... [[32mSELECT 169[0m in 0.35s]
[0m16:34:58.658484 [debug] [Thread-1 (]: Finished running node model.tp_dbt.daily_sales_revenue_by_category
[0m16:34:58.662375 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:58.663180 [debug] [MainThread]: On master: BEGIN
[0m16:34:58.663874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:58.701083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:34:58.702163 [debug] [MainThread]: On master: COMMIT
[0m16:34:58.702978 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:58.704720 [debug] [MainThread]: On master: COMMIT
[0m16:34:58.706706 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:34:58.707760 [debug] [MainThread]: On master: Close
[0m16:34:58.709896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:58.710912 [debug] [MainThread]: Connection 'model.tp_dbt.daily_sales_revenue_by_category' was properly closed.
[0m16:34:58.712002 [info ] [MainThread]: 
[0m16:34:58.713059 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m16:34:58.714841 [debug] [MainThread]: Command end result
[0m16:34:58.732301 [info ] [MainThread]: 
[0m16:34:58.733301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:58.734360 [info ] [MainThread]: 
[0m16:34:58.735192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:34:58.739721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2960567, "process_user_time": 5.863025, "process_kernel_time": 0.740069, "process_mem_max_rss": "107708416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:58.741174 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:58.740888 after 2.30 seconds
[0m16:34:58.742140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc1cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc980e0>]}
[0m16:34:58.744135 [debug] [MainThread]: Flushing usage events
[0m16:43:54.514698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcc0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb58aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcf1d60>]}


============================== 16:43:54.530442 | 9eab54a8-81ab-4b9a-b5d3-69cf951d1687 ==============================
[0m16:43:54.530442 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:43:54.532377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/estelleclement/.dbt', 'log_path': '/Users/estelleclement/Desktop/ESME/IngeÃÅ 2/On Data science tools/tp_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select daily_sales_volume', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:55.086254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eab54a8-81ab-4b9a-b5d3-69cf951d1687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f816e70>]}
[0m16:43:55.348765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eab54a8-81ab-4b9a-b5d3-69cf951d1687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd245c0>]}
[0m16:43:55.351563 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m16:43:55.448487 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:43:55.627165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:55.628245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:55.650320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eab54a8-81ab-4b9a-b5d3-69cf951d1687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc93080>]}
[0m16:43:55.687654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eab54a8-81ab-4b9a-b5d3-69cf951d1687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110564710>]}
[0m16:43:55.688851 [info ] [MainThread]: Found 6 models, 8 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:43:55.690000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eab54a8-81ab-4b9a-b5d3-69cf951d1687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd72330>]}
[0m16:43:55.693844 [info ] [MainThread]: 
[0m16:43:55.698297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:55.706077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:43:55.738904 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:43:55.740839 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:43:55.744023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:55.876382 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:43:55.880083 [debug] [ThreadPool]: On list_postgres: Close
[0m16:43:55.885642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:43:55.900892 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:43:55.902104 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:43:55.902981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:55.932735 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:43:55.933602 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:43:55.934374 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:43:55.941808 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:43:55.945112 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:43:55.946893 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:43:55.961123 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:55.962206 [debug] [MainThread]: On master: BEGIN
[0m16:43:55.963023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:55.991414 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:55.992475 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:55.993867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:56.004648 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:43:56.008915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eab54a8-81ab-4b9a-b5d3-69cf951d1687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5af7d0>]}
[0m16:43:56.010058 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:56.012030 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:56.012974 [debug] [MainThread]: On master: BEGIN
[0m16:43:56.015452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:56.016558 [debug] [MainThread]: On master: COMMIT
[0m16:43:56.017488 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:56.018384 [debug] [MainThread]: On master: COMMIT
[0m16:43:56.020232 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:56.021321 [debug] [MainThread]: On master: Close
[0m16:43:56.023614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:56.025579 [info ] [MainThread]: 
[0m16:43:56.037436 [debug] [Thread-1 (]: Began running node model.tp_dbt.daily_sales_volume
[0m16:43:56.038576 [info ] [Thread-1 (]: 1 of 1 START sql table model public.daily_sales_volume ......................... [RUN]
[0m16:43:56.040221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tp_dbt.daily_sales_volume)
[0m16:43:56.041332 [debug] [Thread-1 (]: Began compiling node model.tp_dbt.daily_sales_volume
[0m16:43:56.063816 [debug] [Thread-1 (]: Writing injected SQL for node "model.tp_dbt.daily_sales_volume"
[0m16:43:56.067179 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_volume (compile): 16:43:56.041859 => 16:43:56.066419
[0m16:43:56.068291 [debug] [Thread-1 (]: Began executing node model.tp_dbt.daily_sales_volume
[0m16:43:56.178961 [debug] [Thread-1 (]: Writing runtime sql for node "model.tp_dbt.daily_sales_volume"
[0m16:43:56.181133 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_volume"
[0m16:43:56.182488 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_volume: BEGIN
[0m16:43:56.183594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:56.238598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:43:56.240162 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_volume"
[0m16:43:56.241384 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_volume: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_volume"} */

  
    

  create  table "postgres"."public"."daily_sales_volume__dbt_tmp"
  
  
    as
  
  (
    

select
    sale_date,
    count(*) as total_sales
from "postgres"."public"."stg_sales"
group by sale_date
  );
  
[0m16:43:56.254526 [debug] [Thread-1 (]: SQL status: SELECT 90 in 0.0 seconds
[0m16:43:56.270017 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_volume"
[0m16:43:56.271044 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_volume: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_volume"} */
alter table "postgres"."public"."daily_sales_volume__dbt_tmp" rename to "daily_sales_volume"
[0m16:43:56.273440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:43:56.321905 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_volume: COMMIT
[0m16:43:56.323167 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_volume"
[0m16:43:56.324222 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_volume: COMMIT
[0m16:43:56.327854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:43:56.345986 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."daily_sales_volume__dbt_backup"
[0m16:43:56.360904 [debug] [Thread-1 (]: Using postgres connection "model.tp_dbt.daily_sales_volume"
[0m16:43:56.362003 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_volume: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "tp_dbt", "target_name": "dev", "node_id": "model.tp_dbt.daily_sales_volume"} */
drop table if exists "postgres"."public"."daily_sales_volume__dbt_backup" cascade
[0m16:43:56.364754 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:43:56.368772 [debug] [Thread-1 (]: Timing info for model.tp_dbt.daily_sales_volume (execute): 16:43:56.069005 => 16:43:56.368196
[0m16:43:56.369823 [debug] [Thread-1 (]: On model.tp_dbt.daily_sales_volume: Close
[0m16:43:56.372350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eab54a8-81ab-4b9a-b5d3-69cf951d1687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071acf0>]}
[0m16:43:56.375417 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.daily_sales_volume .................... [[32mSELECT 90[0m in 0.33s]
[0m16:43:56.378243 [debug] [Thread-1 (]: Finished running node model.tp_dbt.daily_sales_volume
[0m16:43:56.384358 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:56.385803 [debug] [MainThread]: On master: BEGIN
[0m16:43:56.386937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:56.475958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:56.477153 [debug] [MainThread]: On master: COMMIT
[0m16:43:56.478002 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:56.479087 [debug] [MainThread]: On master: COMMIT
[0m16:43:56.480773 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:56.481637 [debug] [MainThread]: On master: Close
[0m16:43:56.483451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:56.484481 [debug] [MainThread]: Connection 'model.tp_dbt.daily_sales_volume' was properly closed.
[0m16:43:56.485683 [info ] [MainThread]: 
[0m16:43:56.487238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m16:43:56.489362 [debug] [MainThread]: Command end result
[0m16:43:56.511756 [info ] [MainThread]: 
[0m16:43:56.513079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:56.514272 [info ] [MainThread]: 
[0m16:43:56.515429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:43:56.519314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1605034, "process_user_time": 5.931498, "process_kernel_time": 0.772035, "process_mem_max_rss": "104476672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:56.521006 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:56.520584 after 2.16 seconds
[0m16:43:56.522662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110743680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107435c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110730e60>]}
[0m16:43:56.525287 [debug] [MainThread]: Flushing usage events
